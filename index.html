<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zayd VIN & Traffic Hub</title>
    <style>
        :root { --primary: #1db954; --dark: #0f0f0f; --card: #1c1c1c; --text: #eee; }
        body { background: var(--dark); color: var(--text); font-family: -apple-system, sans-serif; text-align: center; margin: 0; padding: 15px; line-height: 1.5; }
        
        /* Branding */
        .branding { margin-bottom: 15px; }
        .instagram { display: flex; justify-content: center; align-items: center; gap: 8px; font-weight: bold; margin-bottom: 10px; font-size: 14px; color: #bbb; }
        .instagram img { width: 18px; height: 18px; }
        select#language { padding: 6px 12px; border-radius: 8px; background: #222; color: white; border: 1px solid #444; cursor: pointer; }

        /* Navigation */
        .nav-tabs { display: flex; justify-content: center; gap: 8px; margin: 20px auto; max-width: 400px; }
        .tab-btn { background: #222; border: 1px solid #444; color: #888; padding: 12px; border-radius: 10px; cursor: pointer; flex: 1; font-weight: bold; transition: 0.3s; }
        .tab-btn.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 0 15px rgba(29, 185, 84, 0.2); }

        .container { background: var(--card); margin: 10px auto; padding: 20px; width: 100%; max-width: 420px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.5); box-sizing: border-box; }

        /* VIN Decoder */
        .input-wrapper { position: relative; }
        input#vinInput { width: 100%; padding: 15px; border-radius: 10px; border: 1px solid #333; background: #000; color: var(--primary); font-family: monospace; font-size: 18px; box-sizing: border-box; outline: none; transition: 0.3s; }
        input#vinInput:focus { border-color: var(--primary); }
        #charCount { position: absolute; right: 12px; top: 18px; font-size: 11px; color: #666; }
        #errorMsg { color: #ff4d4d; font-size: 11px; height: 18px; margin-top: 5px; font-weight: bold; }

        button { width: 100%; padding: 14px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.2s; margin-top: 10px; }
        #decodeBtn { background: var(--primary); color: white; }
        .auction-btn { background: #007bff; color: white; }
        .recall-btn { background: #f39c12; color: white; }
        .fines-go-btn { background: #e67e22; color: white; margin-top: 20px; }
        .clear-btn { background: transparent; color: #666; border: 1px solid #333; font-size: 12px; padding: 8px; width: auto; margin: 15px auto 0; display: block; }

        /* Fines Helper */
        .senawia-box { border: 2px dashed var(--primary); padding: 20px; border-radius: 12px; text-align: left; background: rgba(29, 185, 84, 0.05); }
        .guide-item { font-size: 14px; margin: 10px 0; display: flex; align-items: center; gap: 10px; }

        /* History & Cards */
        .history-item { background: #252525; padding: 12px; margin: 8px 0; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; font-family: monospace; }
        .card-result { background: #2a2a2a; padding: 15px; border-radius: 10px; text-align: left; border-left: 4px solid var(--primary); margin-top: 15px; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* VIN Structure Info */
        .vin-example { background: #000; padding: 10px; border-radius: 8px; font-family: monospace; letter-spacing: 2px; color: #444; display: flex; justify-content: center; gap: 2px; }
        .year-char { color: var(--primary); font-weight: bold; text-decoration: underline; }
    </style>
</head>
<body>

<div class="branding">
  <div class="instagram">
    <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Insta">
    <span>Instagram icon : @zayd90000</span>
  </div>
  <select id="language" onchange="changeLanguage()">
    <option value="en">English</option>
    <option value="ku">Ú©ÙˆØ±Ø¯ÛŒ</option>
    <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
  </select>
</div>

<div class="nav-tabs">
  <button id="tabVin" class="tab-btn active" onclick="switchTab('vin')">VIN Decoder</button>
  <button id="tabFines" class="tab-btn" onclick="switchTab('fines')">Erbil Fines</button>
</div>

<div id="vinSection">
    <div class="container">
      <h2 id="structTitle" style="margin:0 0 10px 0; font-size:18px;">VIN Structure Guide</h2>
      <div class="vin-example">
        <span>1</span><span>H</span><span>G</span><span>C</span><span>P</span><span>2</span><span>6</span><span>4</span><span>8</span><span class="year-char" title="Year Code">R</span><span>A</span><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span>
      </div>
      <pre id="vinInfoText" style="text-align:left; font-size:12px; color:#888;"></pre>
    </div>

    <div class="container">
      <h1 id="title" style="margin:0 0 15px 0;">VIN Decoder ğŸš—</h1>
      <div class="input-wrapper">
        <input id="vinInput" maxlength="17" placeholder="Enter 17-digit VIN" oninput="handleInput(this)">
        <div id="charCount">0/17</div>
      </div>
      <div id="errorMsg"></div>
      <button onclick="decodeVIN()" id="decodeBtn">Decode & Search</button>
      <div id="result"></div>
    </div>

    <div class="container" id="historyContainer">
      <h3 id="histTitle" style="margin:0">Recent Searches</h3>
      <div id="historyList"></div>
      <button class="clear-btn" id="clearBtn" onclick="clearHistory()">Clear History</button>
    </div>
</div>

<div id="finesSection" style="display: none;">
    <div class="container">
        <h1 id="finesTitle" style="margin:0">Erbil Traffic Fines</h1>
        <p style="font-size: 14px; color: #888; margin: 10px 0 25px 0;">Use your Senawia (Green Card) to check violations.</p>
        
        <div class="senawia-box">
            <p style="color: var(--primary); font-weight: bold; margin:0 0 10px 0;">ğŸ“‹ Information Required:</p>
            <div class="guide-item">âœ… Plate Number (Ú˜Ù…Ø§Ø±Û•ÛŒ ØªØ§Ø¨Ù„Û†)</div>
            <div class="guide-item">âœ… Registration No. (Ú˜Ù…Ø§Ø±Û•ÛŒ Ø³Ø§ÚµÙ†Ø§Ù…Û•)</div>
        </div>

        <button class="fines-go-btn" onclick="window.open('https://www.erbilpolice.com/fines/')">
            ğŸŒ Open Official Traffic Site
        </button>
    </div>
</div>

<script>
    let lang = "en";
    let history = JSON.parse(localStorage.getItem("vin_history")) || [];

    const years = {'A':2010,'B':2011,'C':2012,'D':2013,'E':2014,'F':2015,'G':2016,'H':2017,'J':2018,'K':2019,'L':2020,'M':2021,'N':2022,'P':2023,'R':2024,'S':2025,'T':2026};
    const flags = {'1':'ğŸ‡ºğŸ‡¸','4':'ğŸ‡ºğŸ‡¸','5':'ğŸ‡ºğŸ‡¸','2':'ğŸ‡¨ğŸ‡¦','3':'ğŸ‡²ğŸ‡½','J':'ğŸ‡¯ğŸ‡µ','K':'ğŸ‡°ğŸ‡·','W':'ğŸ‡©ğŸ‡ª','S':'ğŸ‡¬ğŸ‡§','V':'ğŸ‡«ğŸ‡·','Z':'ğŸ‡®ğŸ‡¹','L':'ğŸ‡¨ğŸ‡³'};
    const brands = {"JHM":"Honda","1HG":"Honda","JT2":"Toyota","JTN":"Toyota","WBA":"BMW","WDC":"Mercedes-Benz","WAU":"Audi","WVW":"Volkswagen","JN1":"Nissan","KMH":"Hyundai","KNA":"Kia","SAL":"Land Rover"};

    const translations = {
        en: { title:"VIN Decoder ğŸš—", btn:"Decode", hist:"Recent Searches", struct:"VIN Guide", tabVin:"VIN Decoder", tabFines:"Erbil Fines", finesTitle:"Traffic Fines", info:"1-3: Manufacturer\n10: Year (Highlighted)\n12-17: Serial No.", clear:"Clear History" },
        ar: { title:"ÙØ­Øµ Ø§Ù„Ø´Ø§ØµÙŠ ğŸš—", btn:"ØªØ­Ù„ÙŠÙ„", hist:"Ø§Ù„Ø£Ø®ÙŠØ±Ø©", struct:"Ø¯Ù„ÙŠÙ„ VIN", tabVin:"ÙØ­Øµ VIN", tabFines:"ØºØ±Ø§Ù…Ø§Øª Ø£Ø±Ø¨ÙŠÙ„", finesTitle:"ØºØ±Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±", info:"1-3: Ø§Ù„Ù…ØµÙ†Ø¹\n10: Ø§Ù„Ø³Ù†Ø© (Ø§Ù„Ù…Ø´Ø§Ø± Ø¥Ù„ÙŠÙ‡Ø§)\n12-17: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ", clear:"Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„" },
        ku: { title:"Ù¾Ø´Ú©Ù†ÛŒÙ†ÛŒ VIN ğŸš—", btn:"Ù¾Ø´Ú©Ù†ÛŒÙ†", hist:"Ú¯Û•Ú•Ø§Ù†Û•Ú©Ø§Ù†", struct:"Ú•ÛØ¨Û•Ø±ÛŒ VIN", tabVin:"Ù¾Ø´Ú©Ù†ÛŒÙ†ÛŒ VIN", tabFines:"Ø³Ø²Ø§Ú©Ø§Ù†ÛŒ Ù‡Û•ÙˆÙ„ÛØ±", finesTitle:"Ø³Ø²Ø§Ú©Ø§Ù†ÛŒ Ù‡Ø§ØªÙˆÙˆÚ†Û†", info:"1-3: Ú©Û†Ø¯ÛŒ Ú©Ø§Ø±Ú¯Û•\n10: Ø³Ø§ÚµÛŒ Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ø¯Ù†\n12-17: Ú˜Ù…Ø§Ø±Û•ÛŒ Ø²Ù†Ø¬ÛŒØ±Û•ÛŒÛŒ", clear:"Ù¾Ø§Ú©Ú©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ù…ÛÚ˜ÙˆÙˆ" }
    };

    function switchTab(tab) {
        document.getElementById('vinSection').style.display = (tab === 'vin') ? 'block' : 'none';
        document.getElementById('finesSection').style.display = (tab === 'fines') ? 'block' : 'none';
        document.getElementById('tabVin').classList.toggle('active', tab === 'vin');
        document.getElementById('tabFines').classList.toggle('active', tab === 'fines');
    }

    function handleInput(input) {
        let val = input.value.toUpperCase();
        const err = document.getElementById("errorMsg");
        if (/[IOQ]/.test(val)) {
            err.innerText = "VINs never use I, O, or Q";
            val = val.replace(/[IOQ]/g, '');
        } else { err.innerText = ""; }
        input.value = val;
        document.getElementById("charCount").innerText = `${val.length}/17`;
    }

    function changeLanguage() {
        lang = document.getElementById("language").value;
        const t = translations[lang];
        document.getElementById("title").innerText = t.title;
        document.getElementById("decodeBtn").innerText = t.btn;
        document.getElementById("histTitle").innerText = t.hist;
        document.getElementById("tabVin").innerText = t.tabVin;
        document.getElementById("tabFines").innerText = t.tabFines;
        document.getElementById("finesTitle").innerText = t.finesTitle;
        document.getElementById("structTitle").innerText = t.struct;
        document.getElementById("vinInfoText").innerText = t.info;
        document.getElementById("clearBtn").innerText = t.clear;
        document.body.style.direction = (lang === 'en') ? 'ltr' : 'rtl';
        updateHistoryUI();
    }

    function decodeVIN(inputVin = null) {
        const vin = (inputVin || document.getElementById("vinInput").value).toUpperCase().trim();
        if (vin.length !== 17) return;

        const flag = flags[vin[0]] || 'ğŸ³ï¸';
        const brand = brands[vin.substring(0,3)] || "Unknown Brand";
        const year = years[vin[9]] || "Unknown";
        
        document.getElementById("result").innerHTML = `
            <div class="card-result">
                <div style="font-size: 20px; font-weight:bold; margin-bottom: 8px;">${flag} ${brand}</div>
                <div style="color: #bbb; font-size: 14px; margin-bottom: 10px;">Model Year: ${year} (${vin[9]})</div>
                <button class="auction-btn" onclick="window.open('https://google.com/search?q=site:bidfax.info+${vin}')">ğŸ–¼ï¸ Auction Photos (Free)</button>
                <button class="recall-btn" onclick="window.open('https://www.nhtsa.gov/recalls?vin=${vin}')">âš ï¸ Check Recalls (Free)</button>
            </div>
        `;
        if (!inputVin) saveToHistory(vin);
    }

    function saveToHistory(vin) {
        if (!history.includes(vin)) {
            history.unshift(vin);
            if (history.length > 5) history.pop();
            localStorage.setItem("vin_history", JSON.stringify(history));
            updateHistoryUI();
        }
    }

    function clearHistory() {
        history = [];
        localStorage.removeItem("vin_history");
        updateHistoryUI();
    }

    function updateHistoryUI() {
        const list = document.getElementById("historyList");
        const container = document.getElementById("historyContainer");
        if (history.length === 0) {
            list.innerHTML = `<p style="color:#444; font-size:12px;">No recent searches</p>`;
            document.getElementById("clearBtn").style.display = "none";
        } else {
            list.innerHTML = history.map(v => `<div class="history-item" onclick="decodeVIN('${v}')"><span>${v}</span><span>ğŸ”</span></div>`).join('');
            document.getElementById("clearBtn").style.display = "block";
        }
    }

    window.onload = changeLanguage;
</script>
</body>
</html>
